"use strict";(self.webpackChunkblog_road=self.webpackChunkblog_road||[]).push([[517],{66262:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,n]of s)a[i]=n;return a}},76210:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>t,data:()=>h});var n=a(20641);const e=[(0,n.Fv)('<h1 id="因素08-掌控控制流" tabindex="-1"><a class="header-anchor" href="#因素08-掌控控制流"><span>因素08：掌控控制流</span></a></h1><blockquote><p>来源：12-Factor Agents / Factor 8（Own your control flow）</p></blockquote><h2 id="一句话先懂" tabindex="-1"><a class="header-anchor" href="#一句话先懂"><span>一句话先懂</span></a></h2><p>控制流（循环、分支、暂停、重试、升级）必须由确定性代码掌控，不能交给模型随意决定。</p><h2 id="奶奶版理解" tabindex="-1"><a class="header-anchor" href="#奶奶版理解"><span>奶奶版理解</span></a></h2><p>导航会建议“右转”，但方向盘和刹车必须在你手里。<br> 遇到施工、堵车、危险路段，你得自己决定绕路还是停车。</p><h2 id="原文核心观点" tabindex="-1"><a class="header-anchor" href="#原文核心观点"><span>原文核心观点</span></a></h2><ul><li>模型可以建议“下一步”。</li><li>程序必须决定“何时继续、何时中断、何时人工接管”。</li><li>尤其在高风险工具执行前，要允许人工审查。</li></ul><h2 id="一种可用控制流模板" tabindex="-1"><a class="header-anchor" href="#一种可用控制流模板"><span>一种可用控制流模板</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">while</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    step </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> llm_decide</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(thread)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> step.intent </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;request_human_input&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;wait_external&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">        save_thread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(thread)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">        notify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(step)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        break</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> step.intent </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;fetch_data&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        result </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> fetch_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(step)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">        append_event</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;fetch_data_result&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, result)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        continue</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> step.intent </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;deploy_production&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">        request_approval</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(step)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">        save_thread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(thread)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        break</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="关键设计点" tabindex="-1"><a class="header-anchor" href="#关键设计点"><span>关键设计点</span></a></h2><ol><li>定义可中断节点（human, long task, high risk）。</li><li>定义重试预算（次数、间隔、是否降级）。</li><li>定义升级策略（转人工、转只读模式、终止并告警）。</li><li>定义最大循环步数，防止跑飞。</li></ol><h2 id="常见误区" tabindex="-1"><a class="header-anchor" href="#常见误区"><span>常见误区</span></a></h2><ul><li>默认无限 loop，无步数上限。</li><li>所有错误都自动重试，不做分类。</li><li>高风险动作没有“选择后执行前”审查窗口。</li></ul><h2 id="我的思考" tabindex="-1"><a class="header-anchor" href="#我的思考"><span>我的思考</span></a></h2><p>这条是系统安全阀。<br> 如果把控制流都让模型“自由发挥”，你会得到看似聪明但不可预测的系统。</p><p>我建议：</p><ul><li>模型做策略建议</li><li>控制流做硬边界</li></ul><p>两者结合才能既灵活又稳。</p><h2 id="小结" tabindex="-1"><a class="header-anchor" href="#小结"><span>小结</span></a></h2><ul><li>控制流是工程资产，不是模型资产。</li><li>可中断、可恢复、可升级是生产必需品。</li><li>没有控制流，就没有真正可控的 agent。</li></ul>',21)],l={},t=(0,a(66262).A)(l,[["render",function(i,s){return(0,n.uX)(),(0,n.CE)("div",null,e)}]]),h=JSON.parse('{"path":"/%E5%A5%B6%E5%A5%B6%E5%85%AB%E8%82%A1/12%E5%9B%A0%E7%B4%A0%E6%99%BA%E8%83%BD%E4%BD%93/08-%E6%8E%8C%E6%8E%A7%E6%8E%A7%E5%88%B6%E6%B5%81.html","title":"因素08：掌控控制流","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2026-02-13T00:00:00.000Z","category":["后端"],"tag":["12因素智能体","大模型","Factor-08"],"description":"因素08：掌控控制流 来源：12-Factor Agents / Factor 8（Own your control flow） 一句话先懂 控制流（循环、分支、暂停、重试、升级）必须由确定性代码掌控，不能交给模型随意决定。 奶奶版理解 导航会建议“右转”，但方向盘和刹车必须在你手里。 遇到施工、堵车、危险路段，你得自己决定绕路还是停车。 原文核心观点...","head":[["meta",{"property":"og:url","content":"https://xlb3055.github.io/newBlog/%E5%A5%B6%E5%A5%B6%E5%85%AB%E8%82%A1/12%E5%9B%A0%E7%B4%A0%E6%99%BA%E8%83%BD%E4%BD%93/08-%E6%8E%8C%E6%8E%A7%E6%8E%A7%E5%88%B6%E6%B5%81.html"}],["meta",{"property":"og:site_name","content":"Bin的技术博客"}],["meta",{"property":"og:title","content":"因素08：掌控控制流"}],["meta",{"property":"og:description","content":"因素08：掌控控制流 来源：12-Factor Agents / Factor 8（Own your control flow） 一句话先懂 控制流（循环、分支、暂停、重试、升级）必须由确定性代码掌控，不能交给模型随意决定。 奶奶版理解 导航会建议“右转”，但方向盘和刹车必须在你手里。 遇到施工、堵车、危险路段，你得自己决定绕路还是停车。 原文核心观点..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-13T07:34:00.000Z"}],["meta",{"property":"article:author","content":"Bin"}],["meta",{"property":"article:tag","content":"12因素智能体"}],["meta",{"property":"article:tag","content":"大模型"}],["meta",{"property":"article:tag","content":"Factor-08"}],["meta",{"property":"article:published_time","content":"2026-02-13T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-13T07:34:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"因素08：掌控控制流\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2026-02-13T00:00:00.000Z\\",\\"dateModified\\":\\"2026-02-13T07:34:00.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Bin\\",\\"url\\":\\"/avator_img.jpg\\"}]}"]]},"headers":[{"level":2,"title":"一句话先懂","slug":"一句话先懂","link":"#一句话先懂","children":[]},{"level":2,"title":"奶奶版理解","slug":"奶奶版理解","link":"#奶奶版理解","children":[]},{"level":2,"title":"原文核心观点","slug":"原文核心观点","link":"#原文核心观点","children":[]},{"level":2,"title":"一种可用控制流模板","slug":"一种可用控制流模板","link":"#一种可用控制流模板","children":[]},{"level":2,"title":"关键设计点","slug":"关键设计点","link":"#关键设计点","children":[]},{"level":2,"title":"常见误区","slug":"常见误区","link":"#常见误区","children":[]},{"level":2,"title":"我的思考","slug":"我的思考","link":"#我的思考","children":[]},{"level":2,"title":"小结","slug":"小结","link":"#小结","children":[]}],"git":{"createdTime":1770968040000,"updatedTime":1770968040000,"contributors":[{"name":"bin","email":"13598151+binxlb@user.noreply.gitee.com","commits":1}]},"readingTime":{"minutes":1.5,"words":449},"filePathRelative":"奶奶八股/12因素智能体/08-掌控控制流.md","localizedDate":"2026年2月13日","excerpt":"\\n<blockquote>\\n<p>来源：12-Factor Agents / Factor 8（Own your control flow）</p>\\n</blockquote>\\n<h2>一句话先懂</h2>\\n<p>控制流（循环、分支、暂停、重试、升级）必须由确定性代码掌控，不能交给模型随意决定。</p>\\n<h2>奶奶版理解</h2>\\n<p>导航会建议“右转”，但方向盘和刹车必须在你手里。<br>\\n遇到施工、堵车、危险路段，你得自己决定绕路还是停车。</p>\\n<h2>原文核心观点</h2>\\n<ul>\\n<li>模型可以建议“下一步”。</li>\\n<li>程序必须决定“何时继续、何时中断、何时人工接管”。</li>\\n<li>尤其在高风险工具执行前，要允许人工审查。</li>\\n</ul>","autoDesc":true}')}}]);