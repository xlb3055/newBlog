"use strict";(self.webpackChunkblog_road=self.webpackChunkblog_road||[]).push([[9680],{6262:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,l]of s)a[i]=l;return a}},6972:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>t,data:()=>h});var l=a(641);const e=[(0,l.Fv)('<h1 id="mysql高性能优化" tabindex="-1"><a class="header-anchor" href="#mysql高性能优化"><span>MySQL高性能优化</span></a></h1><hr><h2 id="_1-数据库命名规范" tabindex="-1"><a class="header-anchor" href="#_1-数据库命名规范"><span><strong>1. 数据库命名规范</strong></span></a></h2><h3 id="_1-1-基础命名规则" tabindex="-1"><a class="header-anchor" href="#_1-1-基础命名规则"><span><strong>1.1 基础命名规则</strong></span></a></h3><ol><li><p><strong>数据库名称</strong>：清晰表达业务含义，禁止使用拼音或缩写。</p><ul><li>示例：<code>user_management</code>（用户管理数据库）</li></ul></li><li><p><strong>表名称</strong>：采用小写字母 + 下划线命名，必须能表达数据内容。</p><ul><li>示例：<code>user_info</code>（用户信息表），<code>order_details</code>（订单详情表）</li></ul></li><li><p><strong>字段名称</strong>：小写字母命名，避免缩写或拼音，需简洁且易懂。</p><ul><li>示例：<code>created_at</code>（创建时间字段），<code>order_id</code>（订单 ID）</li></ul></li><li><p><strong>索引名称</strong>：以 <code>idx_</code> 开头，后跟表名和字段名。</p><ul><li>示例：<code>idx_user_email</code>（表示 <code>user_info</code> 表上的 <code>email</code> 字段索引）</li></ul></li><li><p><strong>约束名称</strong>：使用前缀标明类型：</p><ul><li><code>pk_</code> 表示主键（Primary Key）</li><li><code>fk_</code> 表示外键（Foreign Key）</li><li>示例：<code>pk_user_id</code>，<code>fk_order_user_id</code></li></ul></li></ol><p>**核心点：**命名清晰，方便维护，避免冲突。</p><hr><h2 id="_2-数据库基本设计规范" tabindex="-1"><a class="header-anchor" href="#_2-数据库基本设计规范"><span><strong>2. 数据库基本设计规范</strong></span></a></h2><h3 id="_2-1-存储引擎与字符集" tabindex="-1"><a class="header-anchor" href="#_2-1-存储引擎与字符集"><span><strong>2.1 存储引擎与字符集</strong></span></a></h3><ol><li><p><strong>存储引擎</strong>：所有表必须使用 InnoDB。</p><ul><li><strong>原因</strong>：支持事务、行级锁、高并发，性能优越。</li><li>示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> user_info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    user_id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> PRIMARY KEY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    username </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VARCHAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) ENGINE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">InnoDB;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong>字符集</strong>：统一使用 UTF8 或 UTF8MB4。</p><ul><li><strong>原因</strong>：支持多语言字符，避免乱码问题。</li></ul></li></ol><hr><h3 id="_2-2-表和字段设计规范" tabindex="-1"><a class="header-anchor" href="#_2-2-表和字段设计规范"><span><strong>2.2 表和字段设计规范</strong></span></a></h3><ol><li><p><strong>字段注释</strong>：所有表和字段必须添加注释，方便维护和理解。</p><ul><li>示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> user_info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    user_id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> COMMENT </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;用户ID&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    username </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VARCHAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) COMMENT </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;用户名&#39;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) COMMENT</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;用户信息表&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong>单表大小控制</strong>：建议单表数据量不超过 500 万行，避免性能问题。</p><ul><li><strong>解决方案</strong>：数据量大时，可使用分表或分库。</li></ul></li><li><p><strong>禁止存储大文件</strong>：</p><ul><li><strong>原因</strong>：大文件（如图片、视频）会占用大量空间，降低性能。</li><li><strong>解决方案</strong>：将文件存储在对象存储中（如 OSS），数据库仅存路径。</li></ul></li><li><p><strong>范式与反范式</strong>：</p><ul><li>遵循第三范式（避免冗余数据）。</li><li>适当反范式化以提高查询性能，例如将经常查询的数据存储在同一张表中。</li></ul></li><li><p><strong>禁止在线上直接压力测试</strong>：</p><ul><li><strong>原因</strong>：可能导致服务宕机，应在测试环境进行。</li></ul></li></ol><hr><h2 id="_3-数据库字段设计规范" tabindex="-1"><a class="header-anchor" href="#_3-数据库字段设计规范"><span><strong>3. 数据库字段设计规范</strong></span></a></h2><h3 id="_3-1-数据类型的选择" tabindex="-1"><a class="header-anchor" href="#_3-1-数据类型的选择"><span><strong>3.1 数据类型的选择</strong></span></a></h3><ol><li><p><strong>选择最小数据类型</strong>：</p><ul><li>用 <code>TINYINT</code> 替代 <code>INT</code>，节省存储空间。</li><li>示例：性别字段可以用 <code>TINYINT</code>（0 表示男，1 表示女）。</li></ul></li><li><p><strong>禁止使用 TEXT/BLOB</strong>：</p><ul><li><strong>原因</strong>：存储性能差，查询效率低。</li><li><strong>替代方案</strong>：用 <code>VARCHAR</code> 代替 <code>TEXT</code>。</li></ul></li><li><p><strong>金额使用 DECIMAL 类型</strong>：</p><ul><li><strong>原因</strong>：FLOAT/DOUBLE 有精度问题。</li><li>示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">amount </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DECIMAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) COMMENT </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;金额，精确到小数点后两位&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p><strong>字段默认值和 NULL</strong>：</p><ul><li>避免字段为 NULL，需设置合理的默认值。</li><li><strong>原因</strong>：NULL 会影响索引性能。</li></ul></li></ol><hr><h2 id="_4-索引设计规范" tabindex="-1"><a class="header-anchor" href="#_4-索引设计规范"><span><strong>4. 索引设计规范</strong></span></a></h2><h3 id="_4-1-索引数量" tabindex="-1"><a class="header-anchor" href="#_4-1-索引数量"><span><strong>4.1 索引数量</strong></span></a></h3><ol><li><p>每张表索引数量建议不超过 5 个。</p><ul><li><strong>原因</strong>：索引过多会影响写入性能。</li></ul></li><li><p><strong>每张表必须有主键</strong>：</p><ul><li>使用自增字段作为主键，避免业务字段（如身份证号）作为主键。</li></ul></li><li><p><strong>避免重复索引和冗余索引</strong>：</p><ul><li>示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">-- 冗余索引，idx_username 包含 idx_user</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> idx_user</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_info (user);</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> idx_username</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_info (user, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong>覆盖索引优先</strong>：</p><ul><li>覆盖索引能避免回表查询，提高性能。</li><li>示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_id, username </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_info</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> username </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;john&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">-- 索引字段即查询字段</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ol><hr><h2 id="_5-数据库-sql-开发规范" tabindex="-1"><a class="header-anchor" href="#_5-数据库-sql-开发规范"><span><strong>5. 数据库 SQL 开发规范</strong></span></a></h2><h3 id="_5-1-查询规范" tabindex="-1"><a class="header-anchor" href="#_5-1-查询规范"><span><strong>5.1 查询规范</strong></span></a></h3><ol><li><p>**禁止使用 SELECT ***：</p><ul><li>必须明确列出查询字段：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_id, username </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_info;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p><strong>禁止不列字段的 INSERT</strong>：</p><ul><li>示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_info (user_id, username) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;john&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p><strong>避免隐式转换</strong>：</p><ul><li>示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> phone_number </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;12345678&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">-- phone_number 应为字符串</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p><strong>避免 ORDER BY RAND()</strong>：</p><ul><li><strong>原因</strong>：会导致全表扫描。</li><li><strong>解决方案</strong>：先查询再随机：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_info </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ORDER BY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">LIMIT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ol><hr><h3 id="_5-2-查询优化" tabindex="-1"><a class="header-anchor" href="#_5-2-查询优化"><span><strong>5.2 查询优化</strong></span></a></h3><ol><li><p><strong>优先使用 JOIN 替代子查询</strong>：</p><ul><li><strong>子查询</strong>：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> username </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_info </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">IN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> orders </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> amount </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><strong>JOIN 优化</strong>：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> u</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">username</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user_info u</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">JOIN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> orders o </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ON</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> u</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">user_id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">user_id</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">amount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p><strong>减少 JOIN 的表数量</strong>：</p><ul><li>表数量超过 3 时需考虑分解查询。</li></ul></li><li><p><strong>WHERE 子句中避免函数转换</strong>：</p><ul><li>错误示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> DATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(created_at) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;2023-01-01&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li>优化示例：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> created_at </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;2023-01-01&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> AND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> created_at </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;2023-01-02&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ol><hr><h2 id="_6-数据库操作行为规范" tabindex="-1"><a class="header-anchor" href="#_6-数据库操作行为规范"><span><strong>6. 数据库操作行为规范</strong></span></a></h2><ol><li><p><strong>批量操作分批进行</strong>：</p><ul><li>每次处理不超过 10000 条：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DELETE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> orders </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> created_at </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;2023-01-01&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> LIMIT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p><strong>使用工具修改表结构</strong>：</p><ul><li>对大表修改结构时，使用 <code>pt-online-schema-change</code> 工具避免锁表。</li></ul></li><li><p><strong>权限最小化</strong>：</p><ul><li>数据库账号分级管理，仅授予所需权限：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">GRANT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">UPDATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> ON</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> database_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.* </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">TO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;username&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;host&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ol><hr><h2 id="面试问答可能涉及的深入问题" tabindex="-1"><a class="header-anchor" href="#面试问答可能涉及的深入问题"><span><strong>面试问答可能涉及的深入问题</strong></span></a></h2><h3 id="_1-为什么-varchar-比-text-更推荐" tabindex="-1"><a class="header-anchor" href="#_1-为什么-varchar-比-text-更推荐"><span><strong>1. 为什么 VARCHAR 比 TEXT 更推荐？</strong></span></a></h3><ul><li>VARCHAR 存储在表的行数据中，性能更高；</li><li>TEXT 存储在独立空间，查询需要额外的 I/O 操作。</li></ul><h3 id="_2-如何避免深度分页的性能问题" tabindex="-1"><a class="header-anchor" href="#_2-如何避免深度分页的性能问题"><span><strong>2. 如何避免深度分页的性能问题？</strong></span></a></h3><ul><li>使用索引字段限制：<div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> table</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> LIMIT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h3 id="_3-数据库设计时-什么时候需要反范式" tabindex="-1"><a class="header-anchor" href="#_3-数据库设计时-什么时候需要反范式"><span><strong>3. 数据库设计时，什么时候需要反范式？</strong></span></a></h3><ul><li>在高频查询场景下，适当增加冗余字段，减少表关联操作。</li></ul><hr>',40)],n={},t=(0,a(6262).A)(n,[["render",function(i,s){return(0,l.uX)(),(0,l.CE)("div",null,e)}]]),h=JSON.parse('{"path":"/Java%E5%85%AB%E8%82%A1/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/MySQL%E9%AB%98%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html","title":"MySQL高性能优化","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2024-11-22T00:00:00.000Z","category":["后端"],"tag":["MySQL","数据库"],"description":"MySQL高性能优化 1. 数据库命名规范 1.1 基础命名规则 数据库名称：清晰表达业务含义，禁止使用拼音或缩写。 示例：user_management（用户管理数据库） 表名称：采用小写字母 + 下划线命名，必须能表达数据内容。 示例：user_info（用户信息表），order_details（订单详情表） 字段名称：小写字母命名，避免缩写或拼音...","head":[["meta",{"property":"og:url","content":"https://xlb3055.github.io/newBlog/Java%E5%85%AB%E8%82%A1/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/MySQL%E9%AB%98%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html"}],["meta",{"property":"og:site_name","content":"Bin的成长博客"}],["meta",{"property":"og:title","content":"MySQL高性能优化"}],["meta",{"property":"og:description","content":"MySQL高性能优化 1. 数据库命名规范 1.1 基础命名规则 数据库名称：清晰表达业务含义，禁止使用拼音或缩写。 示例：user_management（用户管理数据库） 表名称：采用小写字母 + 下划线命名，必须能表达数据内容。 示例：user_info（用户信息表），order_details（订单详情表） 字段名称：小写字母命名，避免缩写或拼音..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-06T06:24:41.000Z"}],["meta",{"property":"article:author","content":"Bin"}],["meta",{"property":"article:tag","content":"MySQL"}],["meta",{"property":"article:tag","content":"数据库"}],["meta",{"property":"article:published_time","content":"2024-11-22T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-06-06T06:24:41.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"MySQL高性能优化\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-11-22T00:00:00.000Z\\",\\"dateModified\\":\\"2025-06-06T06:24:41.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Bin\\",\\"url\\":\\"/avator_img.jpg\\"}]}"]]},"headers":[{"level":2,"title":"1. 数据库命名规范","slug":"_1-数据库命名规范","link":"#_1-数据库命名规范","children":[{"level":3,"title":"1.1 基础命名规则","slug":"_1-1-基础命名规则","link":"#_1-1-基础命名规则","children":[]}]},{"level":2,"title":"2. 数据库基本设计规范","slug":"_2-数据库基本设计规范","link":"#_2-数据库基本设计规范","children":[{"level":3,"title":"2.1 存储引擎与字符集","slug":"_2-1-存储引擎与字符集","link":"#_2-1-存储引擎与字符集","children":[]},{"level":3,"title":"2.2 表和字段设计规范","slug":"_2-2-表和字段设计规范","link":"#_2-2-表和字段设计规范","children":[]}]},{"level":2,"title":"3. 数据库字段设计规范","slug":"_3-数据库字段设计规范","link":"#_3-数据库字段设计规范","children":[{"level":3,"title":"3.1 数据类型的选择","slug":"_3-1-数据类型的选择","link":"#_3-1-数据类型的选择","children":[]}]},{"level":2,"title":"4. 索引设计规范","slug":"_4-索引设计规范","link":"#_4-索引设计规范","children":[{"level":3,"title":"4.1 索引数量","slug":"_4-1-索引数量","link":"#_4-1-索引数量","children":[]}]},{"level":2,"title":"5. 数据库 SQL 开发规范","slug":"_5-数据库-sql-开发规范","link":"#_5-数据库-sql-开发规范","children":[{"level":3,"title":"5.1 查询规范","slug":"_5-1-查询规范","link":"#_5-1-查询规范","children":[]},{"level":3,"title":"5.2 查询优化","slug":"_5-2-查询优化","link":"#_5-2-查询优化","children":[]}]},{"level":2,"title":"6. 数据库操作行为规范","slug":"_6-数据库操作行为规范","link":"#_6-数据库操作行为规范","children":[]},{"level":2,"title":"面试问答可能涉及的深入问题","slug":"面试问答可能涉及的深入问题","link":"#面试问答可能涉及的深入问题","children":[{"level":3,"title":"1. 为什么 VARCHAR 比 TEXT 更推荐？","slug":"_1-为什么-varchar-比-text-更推荐","link":"#_1-为什么-varchar-比-text-更推荐","children":[]},{"level":3,"title":"2. 如何避免深度分页的性能问题？","slug":"_2-如何避免深度分页的性能问题","link":"#_2-如何避免深度分页的性能问题","children":[]},{"level":3,"title":"3. 数据库设计时，什么时候需要反范式？","slug":"_3-数据库设计时-什么时候需要反范式","link":"#_3-数据库设计时-什么时候需要反范式","children":[]}]}],"git":{"createdTime":1732275083000,"updatedTime":1749191081000,"contributors":[{"name":"bin","email":"13598151+binxlb@user.noreply.gitee.com","commits":1}]},"readingTime":{"minutes":4.32,"words":1295},"filePathRelative":"Java八股/数据库/MySQL/MySQL高性能优化.md","localizedDate":"2024年11月22日","excerpt":"\\n<hr>\\n<h2><strong>1. 数据库命名规范</strong></h2>\\n<h3><strong>1.1 基础命名规则</strong></h3>\\n<ol>\\n<li>\\n<p><strong>数据库名称</strong>：清晰表达业务含义，禁止使用拼音或缩写。</p>\\n<ul>\\n<li>示例：<code>user_management</code>（用户管理数据库）</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>表名称</strong>：采用小写字母 + 下划线命名，必须能表达数据内容。</p>\\n<ul>\\n<li>示例：<code>user_info</code>（用户信息表），<code>order_details</code>（订单详情表）</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>字段名称</strong>：小写字母命名，避免缩写或拼音，需简洁且易懂。</p>\\n<ul>\\n<li>示例：<code>created_at</code>（创建时间字段），<code>order_id</code>（订单 ID）</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>索引名称</strong>：以 <code>idx_</code> 开头，后跟表名和字段名。</p>\\n<ul>\\n<li>示例：<code>idx_user_email</code>（表示 <code>user_info</code> 表上的 <code>email</code> 字段索引）</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>约束名称</strong>：使用前缀标明类型：</p>\\n<ul>\\n<li><code>pk_</code> 表示主键（Primary Key）</li>\\n<li><code>fk_</code> 表示外键（Foreign Key）</li>\\n<li>示例：<code>pk_user_id</code>，<code>fk_order_user_id</code></li>\\n</ul>\\n</li>\\n</ol>","autoDesc":true}')}}]);