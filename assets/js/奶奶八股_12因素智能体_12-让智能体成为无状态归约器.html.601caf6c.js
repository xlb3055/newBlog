"use strict";(self.webpackChunkblog_road=self.webpackChunkblog_road||[]).push([[383],{66262:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,t]of i)a[s]=t;return a}},15809:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>l,data:()=>h});var t=a(20641);const n=[(0,t.Fv)('<h1 id="因素12-让智能体成为无状态归约器" tabindex="-1"><a class="header-anchor" href="#因素12-让智能体成为无状态归约器"><span>因素12：让智能体成为无状态归约器</span></a></h1><blockquote><p>来源：12-Factor Agents / Factor 12（Make your agent a stateless reducer）</p></blockquote><h2 id="一句话先懂" tabindex="-1"><a class="header-anchor" href="#一句话先懂"><span>一句话先懂</span></a></h2><p>把核心逻辑做成“纯归约”：输入旧状态和新事件，输出新状态与待执行动作，便于测试、回放和扩展。</p><h2 id="奶奶版理解" tabindex="-1"><a class="header-anchor" href="#奶奶版理解"><span>奶奶版理解</span></a></h2><p>记账规则很简单：</p><ul><li>旧余额 + 新流水 = 新余额</li></ul><p>规则固定，就能重复算、反复查，不会乱。</p><h2 id="原文精神" tabindex="-1"><a class="header-anchor" href="#原文精神"><span>原文精神</span></a></h2><p>Factor 12 偏工程审美，但非常实用：让 agent 逻辑更函数式、可推导、可验证，而不是到处散落副作用。</p><h2 id="简化模型" tabindex="-1"><a class="header-anchor" href="#简化模型"><span>简化模型</span></a></h2><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> State</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">events</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Event</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] };</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Effect</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;"> string</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">payload</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;"> unknown</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> };</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> reducer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">state</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> State</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">event</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Event</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">state</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> State</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">effects</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Effect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] } {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> next</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">...</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">state</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">events</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">...</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">state</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E06C75;">events</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">event</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] };</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">event</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;human_response&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      state</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> next</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      effects</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [{ </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;resume_agent&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">payload</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">threadId</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> event</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E06C75;">threadId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> } }]</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    };</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">state</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> next</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">effects</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [] };</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>副作用执行器（调用 API、发消息）放在 reducer 外部。</p><h2 id="为什么值钱" tabindex="-1"><a class="header-anchor" href="#为什么值钱"><span>为什么值钱</span></a></h2><ul><li><strong>可重放</strong>：重放事件可复现状态。</li><li><strong>可测试</strong>：同输入必得同输出。</li><li><strong>可演进</strong>：新增事件类型即可扩展能力。</li><li><strong>可审计</strong>：每一步状态变化有据可查。</li></ul><h2 id="常见误区" tabindex="-1"><a class="header-anchor" href="#常见误区"><span>常见误区</span></a></h2><ul><li>在 reducer 内直接发请求，破坏纯函数。</li><li>直接改写 state（mutable），导致不可重现。</li><li>事件版本管理缺失，升级后历史无法兼容。</li></ul><h2 id="我的思考" tabindex="-1"><a class="header-anchor" href="#我的思考"><span>我的思考</span></a></h2><p>这条是“长期主义”工程实践。<br> 短期看它可能有点重，但当系统规模变大（多团队、多渠道、多审批）时，它会极大降低维护成本。</p><h2 id="小结" tabindex="-1"><a class="header-anchor" href="#小结"><span>小结</span></a></h2><ul><li>归约器思想让 agent 从“脚本”升级为“系统”。</li><li>纯逻辑与副作用分离，是稳定性的关键。</li><li>当你要做可扩展、可审计智能体时，这条非常重要。</li></ul>',21)],e={},l=(0,a(66262).A)(e,[["render",function(s,i){return(0,t.uX)(),(0,t.CE)("div",null,n)}]]),h=JSON.parse('{"path":"/%E5%A5%B6%E5%A5%B6%E5%85%AB%E8%82%A1/12%E5%9B%A0%E7%B4%A0%E6%99%BA%E8%83%BD%E4%BD%93/12-%E8%AE%A9%E6%99%BA%E8%83%BD%E4%BD%93%E6%88%90%E4%B8%BA%E6%97%A0%E7%8A%B6%E6%80%81%E5%BD%92%E7%BA%A6%E5%99%A8.html","title":"因素12：让智能体成为无状态归约器","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2026-02-13T00:00:00.000Z","category":["后端"],"tag":["12因素智能体","大模型","Factor-12"],"description":"因素12：让智能体成为无状态归约器 来源：12-Factor Agents / Factor 12（Make your agent a stateless reducer） 一句话先懂 把核心逻辑做成“纯归约”：输入旧状态和新事件，输出新状态与待执行动作，便于测试、回放和扩展。 奶奶版理解 记账规则很简单： 旧余额 + 新流水 = 新余额 规则固定，就...","head":[["meta",{"property":"og:url","content":"https://xlb3055.github.io/newBlog/%E5%A5%B6%E5%A5%B6%E5%85%AB%E8%82%A1/12%E5%9B%A0%E7%B4%A0%E6%99%BA%E8%83%BD%E4%BD%93/12-%E8%AE%A9%E6%99%BA%E8%83%BD%E4%BD%93%E6%88%90%E4%B8%BA%E6%97%A0%E7%8A%B6%E6%80%81%E5%BD%92%E7%BA%A6%E5%99%A8.html"}],["meta",{"property":"og:site_name","content":"Bin的技术博客"}],["meta",{"property":"og:title","content":"因素12：让智能体成为无状态归约器"}],["meta",{"property":"og:description","content":"因素12：让智能体成为无状态归约器 来源：12-Factor Agents / Factor 12（Make your agent a stateless reducer） 一句话先懂 把核心逻辑做成“纯归约”：输入旧状态和新事件，输出新状态与待执行动作，便于测试、回放和扩展。 奶奶版理解 记账规则很简单： 旧余额 + 新流水 = 新余额 规则固定，就..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-13T07:34:00.000Z"}],["meta",{"property":"article:author","content":"Bin"}],["meta",{"property":"article:tag","content":"12因素智能体"}],["meta",{"property":"article:tag","content":"大模型"}],["meta",{"property":"article:tag","content":"Factor-12"}],["meta",{"property":"article:published_time","content":"2026-02-13T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-13T07:34:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"因素12：让智能体成为无状态归约器\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2026-02-13T00:00:00.000Z\\",\\"dateModified\\":\\"2026-02-13T07:34:00.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Bin\\",\\"url\\":\\"/avator_img.jpg\\"}]}"]]},"headers":[{"level":2,"title":"一句话先懂","slug":"一句话先懂","link":"#一句话先懂","children":[]},{"level":2,"title":"奶奶版理解","slug":"奶奶版理解","link":"#奶奶版理解","children":[]},{"level":2,"title":"原文精神","slug":"原文精神","link":"#原文精神","children":[]},{"level":2,"title":"简化模型","slug":"简化模型","link":"#简化模型","children":[]},{"level":2,"title":"为什么值钱","slug":"为什么值钱","link":"#为什么值钱","children":[]},{"level":2,"title":"常见误区","slug":"常见误区","link":"#常见误区","children":[]},{"level":2,"title":"我的思考","slug":"我的思考","link":"#我的思考","children":[]},{"level":2,"title":"小结","slug":"小结","link":"#小结","children":[]}],"git":{"createdTime":1770968040000,"updatedTime":1770968040000,"contributors":[{"name":"bin","email":"13598151+binxlb@user.noreply.gitee.com","commits":1}]},"readingTime":{"minutes":1.48,"words":444},"filePathRelative":"奶奶八股/12因素智能体/12-让智能体成为无状态归约器.md","localizedDate":"2026年2月13日","excerpt":"\\n<blockquote>\\n<p>来源：12-Factor Agents / Factor 12（Make your agent a stateless reducer）</p>\\n</blockquote>\\n<h2>一句话先懂</h2>\\n<p>把核心逻辑做成“纯归约”：输入旧状态和新事件，输出新状态与待执行动作，便于测试、回放和扩展。</p>\\n<h2>奶奶版理解</h2>\\n<p>记账规则很简单：</p>\\n<ul>\\n<li>旧余额 + 新流水 = 新余额</li>\\n</ul>\\n<p>规则固定，就能重复算、反复查，不会乱。</p>\\n<h2>原文精神</h2>\\n<p>Factor 12 偏工程审美，但非常实用：让 agent 逻辑更函数式、可推导、可验证，而不是到处散落副作用。</p>","autoDesc":true}')}}]);