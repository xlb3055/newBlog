"use strict";(self.webpackChunkblog_road=self.webpackChunkblog_road||[]).push([[1712],{66262:(i,e)=>{e.A=(i,e)=>{const t=i.__vccOpts||i;for(const[i,a]of e)t[i]=a;return t}},93974:(i,e,t)=>{t.r(e),t.d(e,{comp:()=>l,data:()=>r});var a=t(20641);const s=[(0,a.Fv)('<h1 id="因素09-把错误压缩进上下文" tabindex="-1"><a class="header-anchor" href="#因素09-把错误压缩进上下文"><span>因素09：把错误压缩进上下文</span></a></h1><blockquote><p>来源：12-Factor Agents / Factor 9（Compact Errors into Context Window）</p></blockquote><h2 id="一句话先懂" tabindex="-1"><a class="header-anchor" href="#一句话先懂"><span>一句话先懂</span></a></h2><p>把错误转成结构化、可行动的信息回灌给模型，促成自愈；同时严格限制重试，避免无限打转。</p><h2 id="奶奶版理解" tabindex="-1"><a class="header-anchor" href="#奶奶版理解"><span>奶奶版理解</span></a></h2><p>做菜失败了，不是直接放弃，而是记住“这次盐放多了”，下一次修正。<br> 但连错三次就要请会做的人帮忙，而不是死磕。</p><h2 id="原文核心思想" tabindex="-1"><a class="header-anchor" href="#原文核心思想"><span>原文核心思想</span></a></h2><ul><li>agent 的优势之一是自恢复。</li><li>工具失败后，模型读到错误信息，常能修正下一步。</li><li>但必须配合控制策略，不然会 error spin（错误旋转）。</li></ul><h2 id="推荐错误压缩格式" tabindex="-1"><a class="header-anchor" href="#推荐错误压缩格式"><span>推荐错误压缩格式</span></a></h2><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;type&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;tool&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;deploy_backend&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;category&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;network_timeout&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;message&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;connect deploy-service timeout&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;retryable&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;hint&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;check service health or retry with backoff&quot;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重点不是“日志越多越好”，而是“可行动信息越清晰越好”。</p><h2 id="落地策略" tabindex="-1"><a class="header-anchor" href="#落地策略"><span>落地策略</span></a></h2><ol><li>错误分类：参数错误 / 权限错误 / 外部依赖错误 / 业务冲突。</li><li>按类别设定重试预算（如最多 2-3 次）。</li><li>重试失败触发升级（人工或降级策略）。</li><li>已修复错误做上下文压缩，避免污染注意力。</li></ol><h2 id="常见误区" tabindex="-1"><a class="header-anchor" href="#常见误区"><span>常见误区</span></a></h2><ul><li>原始堆栈整段塞上下文，token 爆炸。</li><li>不设重试上限，陷入死循环。</li><li>把不可恢复错误也当可恢复处理。</li></ul><h2 id="我的思考" tabindex="-1"><a class="header-anchor" href="#我的思考"><span>我的思考</span></a></h2><p>这条和 Factor 8 是一对组合拳：</p><ul><li>Factor 9 给“修复能力”</li><li>Factor 8 给“停止边界”</li></ul><p>只有两者一起，才能既聪明又不失控。</p><h2 id="小结" tabindex="-1"><a class="header-anchor" href="#小结"><span>小结</span></a></h2><ul><li>错误要回灌，但要压缩和结构化。</li><li>自愈必须有预算，不能无限重试。</li><li>真正稳定的系统是“会修复，也会止损”。</li></ul>',21)],n={},l=(0,t(66262).A)(n,[["render",function(i,e){return(0,a.uX)(),(0,a.CE)("div",null,s)}]]),r=JSON.parse('{"path":"/%E5%A5%B6%E5%A5%B6%E5%85%AB%E8%82%A1/12%E5%9B%A0%E7%B4%A0%E6%99%BA%E8%83%BD%E4%BD%93/09-%E6%8A%8A%E9%94%99%E8%AF%AF%E5%8E%8B%E7%BC%A9%E8%BF%9B%E4%B8%8A%E4%B8%8B%E6%96%87.html","title":"因素09：把错误压缩进上下文","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2026-02-13T00:00:00.000Z","category":["后端"],"tag":["12因素智能体","大模型","Factor-09"],"description":"因素09：把错误压缩进上下文 来源：12-Factor Agents / Factor 9（Compact Errors into Context Window） 一句话先懂 把错误转成结构化、可行动的信息回灌给模型，促成自愈；同时严格限制重试，避免无限打转。 奶奶版理解 做菜失败了，不是直接放弃，而是记住“这次盐放多了”，下一次修正。 但连错三次就要...","head":[["meta",{"property":"og:url","content":"https://xlb3055.github.io/newBlog/%E5%A5%B6%E5%A5%B6%E5%85%AB%E8%82%A1/12%E5%9B%A0%E7%B4%A0%E6%99%BA%E8%83%BD%E4%BD%93/09-%E6%8A%8A%E9%94%99%E8%AF%AF%E5%8E%8B%E7%BC%A9%E8%BF%9B%E4%B8%8A%E4%B8%8B%E6%96%87.html"}],["meta",{"property":"og:site_name","content":"Bin的技术博客"}],["meta",{"property":"og:title","content":"因素09：把错误压缩进上下文"}],["meta",{"property":"og:description","content":"因素09：把错误压缩进上下文 来源：12-Factor Agents / Factor 9（Compact Errors into Context Window） 一句话先懂 把错误转成结构化、可行动的信息回灌给模型，促成自愈；同时严格限制重试，避免无限打转。 奶奶版理解 做菜失败了，不是直接放弃，而是记住“这次盐放多了”，下一次修正。 但连错三次就要..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-13T07:34:00.000Z"}],["meta",{"property":"article:author","content":"Bin"}],["meta",{"property":"article:tag","content":"12因素智能体"}],["meta",{"property":"article:tag","content":"大模型"}],["meta",{"property":"article:tag","content":"Factor-09"}],["meta",{"property":"article:published_time","content":"2026-02-13T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-13T07:34:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"因素09：把错误压缩进上下文\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2026-02-13T00:00:00.000Z\\",\\"dateModified\\":\\"2026-02-13T07:34:00.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Bin\\",\\"url\\":\\"/avator_img.jpg\\"}]}"]]},"headers":[{"level":2,"title":"一句话先懂","slug":"一句话先懂","link":"#一句话先懂","children":[]},{"level":2,"title":"奶奶版理解","slug":"奶奶版理解","link":"#奶奶版理解","children":[]},{"level":2,"title":"原文核心思想","slug":"原文核心思想","link":"#原文核心思想","children":[]},{"level":2,"title":"推荐错误压缩格式","slug":"推荐错误压缩格式","link":"#推荐错误压缩格式","children":[]},{"level":2,"title":"落地策略","slug":"落地策略","link":"#落地策略","children":[]},{"level":2,"title":"常见误区","slug":"常见误区","link":"#常见误区","children":[]},{"level":2,"title":"我的思考","slug":"我的思考","link":"#我的思考","children":[]},{"level":2,"title":"小结","slug":"小结","link":"#小结","children":[]}],"git":{"createdTime":1770968040000,"updatedTime":1770968040000,"contributors":[{"name":"bin","email":"13598151+binxlb@user.noreply.gitee.com","commits":1}]},"readingTime":{"minutes":1.52,"words":456},"filePathRelative":"奶奶八股/12因素智能体/09-把错误压缩进上下文.md","localizedDate":"2026年2月13日","excerpt":"\\n<blockquote>\\n<p>来源：12-Factor Agents / Factor 9（Compact Errors into Context Window）</p>\\n</blockquote>\\n<h2>一句话先懂</h2>\\n<p>把错误转成结构化、可行动的信息回灌给模型，促成自愈；同时严格限制重试，避免无限打转。</p>\\n<h2>奶奶版理解</h2>\\n<p>做菜失败了，不是直接放弃，而是记住“这次盐放多了”，下一次修正。<br>\\n但连错三次就要请会做的人帮忙，而不是死磕。</p>\\n<h2>原文核心思想</h2>\\n<ul>\\n<li>agent 的优势之一是自恢复。</li>\\n<li>工具失败后，模型读到错误信息，常能修正下一步。</li>\\n<li>但必须配合控制策略，不然会 error spin（错误旋转）。</li>\\n</ul>","autoDesc":true}')}}]);