---
icon: pen-to-square
date: 2025-7-9
category:
- åç«¯
tag:
- Java
- é¢è¯•
- åœºæ™¯
---


# ğŸš€ å¦‚ä½•ç”¨æ‰«æçº¿ç®—æ³•ç»Ÿè®¡æœ€å¤§å¹¶å‘æ•°ï¼Ÿä»¥ 5000 ä¸‡æ¡è®°å½•ä¸ºä¾‹è®²æ¸…æ¥šï¼

---

## ğŸ“– èƒŒæ™¯åœºæ™¯ï¼ˆé¢˜ç›®ï¼‰

æœ‰ä¸€å¼ æ•°æ®åº“è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

* `id`ï¼šä¸»é”®ï¼Œè‡ªå¢
* `start_time`ï¼šä¸šåŠ¡å¼€å§‹æ—¶é—´
* `end_time`ï¼šä¸šåŠ¡ç»“æŸæ—¶é—´

è¡¨ä¸­ä¸€å…±æœ‰ **5000 ä¸‡æ¡è®°å½•**ï¼Œæ¯æ¡è®°å½•ä»£è¡¨ä¸€ä¸ªâ€œæ—¶é—´æ®µâ€ï¼ˆä¾‹å¦‚ä¸€ä¸ªç”¨æˆ·ä¼šè¯ã€ä¸€æ¬¡ä»»åŠ¡æ‰§è¡Œç­‰ï¼‰ã€‚

> ğŸ’¡ é—®é¢˜æ˜¯ï¼š**åœ¨æ‰€æœ‰æ—¶é—´ç‚¹ä¸­ï¼Œå“ªä¸€ç§’å¹¶å‘é‡æœ€å¤§ï¼Ÿæœ€å¤šæœ‰å¤šå°‘æ¡è®°å½•åœ¨è¯¥ç§’åŒæ—¶å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Ÿ**

---

## ğŸ¯ æœ¬è´¨æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿ

è¿™å…¶å®æ˜¯ç»å…¸çš„**æœ€å¤§åŒºé—´é‡å é—®é¢˜ï¼ˆMaximum Overlap Intervalï¼‰**ã€‚

é€šä¿—ç‚¹è¯´ï¼š

> æŠŠæ¯æ¡è®°å½•çœ‹ä½œä¸€ä¸ªæ—¶é—´æ®µï¼Œç°åœ¨è¦æ‰¾ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œå®ƒè¢«æœ€å¤šæ¡è®°å½•â€œè¦†ç›–â€ã€‚

---

## ğŸ§  ä¸¾ä¸ªé€šä¿—ä¾‹å­ï¼š

å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹3æ¡è®°å½•ï¼š

| id | start\_time | end\_time |
| -- | ----------- | --------- |
| 1  | 10:00:00    | 10:05:00  |
| 2  | 10:03:00    | 10:08:00  |
| 3  | 10:04:00    | 10:07:00  |

æˆ‘ä»¬å¸Œæœ›çŸ¥é“ï¼šå“ªä¸€ç§’â€œåœ¨çº¿äººæ•°æœ€å¤šâ€ï¼Ÿ

ğŸ“Š åˆ†æä¸€ä¸‹ï¼š

* 10:00 \~ 10:03 â†’ 1æ¡
* 10:03 \~ 10:04 â†’ 2æ¡
* 10:04 \~ 10:05 â†’ 3æ¡ âœ… æœ€å¤§å€¼
* 10:05 \~ 10:07 â†’ 2æ¡
* 10:07 \~ 10:08 â†’ 1æ¡

æœ€ç»ˆæˆ‘ä»¬å¾—åˆ°ï¼š**æœ€å¤§å¹¶å‘æ•°æ˜¯ 3**

---

## âš™ï¸ è§£æ³•æ€è·¯ï¼šæ‰«æçº¿ç®—æ³•ï¼ˆå·®åˆ†æ€æƒ³ï¼‰

è¿™ä¸ªé—®é¢˜åœ¨é¢è¯•å’Œå¤§æ•°æ®ç³»ç»Ÿä¸­éå¸¸å¸¸è§ï¼Œä¸»æµè§£æ³•æ˜¯ï¼š

### âœ… æ‰«æçº¿ç®—æ³•ï¼ˆSweep Lineï¼‰

æ ¸å¿ƒæ€è·¯ï¼š

1. æ¯ä¸ªåŒºé—´çš„å¼€å§‹æ—¶é—´ `start_time`ï¼Œä½œä¸º +1 çš„äº‹ä»¶ï¼ˆè¿›å…¥ï¼‰
2. æ¯ä¸ªåŒºé—´çš„ç»“æŸæ—¶é—´ `end_time`ï¼Œä½œä¸º -1 çš„äº‹ä»¶ï¼ˆé€€å‡ºï¼‰
3. æŠŠæ‰€æœ‰æ—¶é—´ç‚¹æ‰å¹³åŒ–ã€æ‰“ä¸Šæ ‡ç­¾ï¼ˆ+1 / -1ï¼‰ï¼ŒæŒ‰æ—¶é—´ä»å°åˆ°å¤§æ’åº
4. ä»å¤´å¼€å§‹æ‰«æï¼Œæ¯é‡åˆ°ä¸€ä¸ªæ—¶é—´ç‚¹å°±ç´¯åŠ  +1 æˆ– -1ï¼Œç»´æŠ¤å½“å‰å¹¶å‘æ•°
5. éšæ—¶æ›´æ–°æœ€å¤§å€¼

---

## ğŸ’» Java å®ç°ä»£ç 

```java
class Interval {
    LocalDateTime start, end;
    public Interval(LocalDateTime start, LocalDateTime end) {
        this.start = start;
        this.end = end;
    }
}

class Event {
    LocalDateTime time;
    int delta; // +1 è¡¨ç¤ºå¼€å§‹ï¼Œ-1 è¡¨ç¤ºç»“æŸ

    public Event(LocalDateTime time, int delta) {
        this.time = time;
        this.delta = delta;
    }
}

public class MaxConcurrencyCounter {

    public int getMaxConcurrent(List<Interval> intervals) {
        List<Event> events = new ArrayList<>();

        // æ‹†è§£ä¸ºæ—¶é—´ç‚¹äº‹ä»¶
        for (Interval interval : intervals) {
            events.add(new Event(interval.start, +1));
            events.add(new Event(interval.end, -1));
        }

        // æ’åºï¼šæ—¶é—´å‡åºï¼Œç›¸åŒæ—¶é—´ç‚¹å…ˆå¤„ç† +1
        events.sort((a, b) -> {
            if (!a.time.equals(b.time)) {
                return a.time.compareTo(b.time);
            } else {
                return b.delta - a.delta; // +1 æ¯” -1 å…ˆå¤„ç†
            }
        });

        // æ‰«æ + ç»Ÿè®¡æœ€å¤§å€¼
        int current = 0;
        int max = 0;
        for (Event e : events) {
            current += e.delta;
            max = Math.max(max, current);
        }

        return max;
    }
}
```

---

## ğŸ§® SQL è§£æ³•æ€è·¯ï¼ˆé€‚ç”¨äº MySQL/PostgreSQLï¼‰

è™½ç„¶ SQL æ²¡æœ‰â€œæ‰«æçº¿â€ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨â€œ**äº‹ä»¶æ‹†è§£ + ç´¯è®¡**â€æ¥æ¨¡æ‹Ÿï¼

### ğŸ“Œ æ­¥éª¤å¦‚ä¸‹ï¼š

1. æŠŠæ¯æ¡è®°å½•çš„ `start_time` å˜æˆä¸€ä¸ª â€œ+1â€ çš„äº‹ä»¶
2. æŠŠæ¯æ¡è®°å½•çš„ `end_time` å˜æˆä¸€ä¸ª â€œ-1â€ çš„äº‹ä»¶
3. UNION åˆå¹¶èµ·æ¥
4. ç”¨ `çª—å£å‡½æ•°` å¯¹è¿™äº›äº‹ä»¶ç‚¹è¿›è¡ŒæŒ‰æ—¶é—´æ’åºç´¯è®¡

---

## ğŸ§ª SQL å®ç°ç¤ºä¾‹

```sql
-- å‡è®¾æœ‰è¡¨ events(id, start_time, end_time)
-- 1. åˆå¹¶æ—¶é—´äº‹ä»¶
WITH points AS (
  SELECT start_time AS event_time, 1 AS delta FROM events
  UNION ALL
  SELECT end_time AS event_time, -1 AS delta FROM events
),

-- 2. æ‰«æç´¯è®¡å½“å‰å¹¶å‘
concurrent_count AS (
  SELECT 
    event_time,
    SUM(delta) OVER (ORDER BY event_time) AS concurrent
  FROM points
)

-- 3. æ‰¾æœ€å¤§å¹¶å‘æ—¶åˆ»
SELECT MAX(concurrent) AS max_concurrent
FROM concurrent_count;
```

---

## ğŸ” å¤æ‚åº¦åˆ†æ

| æ­¥éª¤     | æ—¶é—´å¤æ‚åº¦      | è¯´æ˜            |
| ------ | ---------- | ------------- |
| æ‹†è§£ä¸ºæ—¶é—´ç‚¹ | O(N)       | æ¯æ¡è®°å½•æ‹†ä¸¤æ¡äº‹ä»¶     |
| æ’åº     | O(N log N) | ä¸»è¦è€—æ—¶åœ¨è¿™ä¸€æ­¥      |
| æ‰«æ     | O(N)       | ä¸€æ¬¡çº¿æ€§æ‰«æç´¯è®¡å½“å‰å¹¶å‘æ•° |

æ‰€ä»¥æ•´ä½“å¤æ‚åº¦ï¼š**O(N log N)**ï¼Œå¯ä»¥åº”å¯¹ 5000 ä¸‡æ¡æ•°æ®ï¼

---

## âœ… å°ç»“ä¸€ä¸‹

| æ–¹æ³•          | é€‚ç”¨åœºæ™¯          | ä¼˜ç‚¹         |
| ----------- | ------------- | ---------- |
| æ‰«æçº¿ç®—æ³•ï¼ˆJavaï¼‰ | é¢è¯•ã€é«˜æ€§èƒ½æœåŠ¡ã€æ—¥å¿—åˆ†æ | é€»è¾‘æ¸…æ™°ï¼Œæ€§èƒ½å¼º   |
| SQL + çª—å£å‡½æ•°  | æ•°æ®ä»“åº“ã€BI åˆ†æ    | æ•°æ®ä¸å‡ºåº“ï¼Œç›´æ¥æŸ¥è¯¢ |

---



