---
icon: pen-to-square
date: 2025-12-10
category:
- åç«¯
tag:
- æ ˆ
- å­—ç¬¦ä¸²
- leetcode
---

# 394. å­—ç¬¦ä¸²è§£ç 

## ğŸ“ é¢˜ç›®æè¿°
ç»™å®šä¸€ä¸ªç»è¿‡ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè¿”å›å®ƒè§£ç åçš„å­—ç¬¦ä¸²ã€‚
ç¼–ç è§„åˆ™ä¸ºï¼š`k[encoded_string]`ï¼Œè¡¨ç¤ºå…¶ä¸­æ–¹æ‹¬å·å†…éƒ¨çš„ `encoded_string` æ­£å¥½é‡å¤ `k` æ¬¡ï¼ˆ`k` æ˜¯æ­£æ•´æ•°ï¼‰ã€‚
æ³¨æ„ï¼šè¾“å…¥å­—ç¬¦ä¸²æ€»æ˜¯æœ‰æ•ˆçš„ï¼Œæ— é¢å¤–ç©ºæ ¼ï¼Œä¸”æ‹¬å·æ ¼å¼åˆæ³•ï¼›æ‰€æœ‰æ•°å­—åªè¡¨ç¤ºé‡å¤æ¬¡æ•° `k`ï¼ˆä¸ä¼šå‡ºç° `3a` æˆ– `2[4]` è¿™ç±»è¾“å…¥ï¼‰ã€‚


---

## ğŸ“Œ ç¤ºä¾‹

### ç¤ºä¾‹ 1
è¾“å…¥ï¼š
```
s = "3[a]2[bc]"
```
è¾“å‡ºï¼š
```
"aaabcbc"
```


### ç¤ºä¾‹ 2
è¾“å…¥ï¼š
```
s = "3[a2[c]]"
```
è¾“å‡ºï¼š
```
"accaccacc"
```


### ç¤ºä¾‹ 3
è¾“å…¥ï¼š
```
s = "2[abc]3[cd]ef"
```
è¾“å‡ºï¼š
```
"abcabccdcdcdef"
```


### ç¤ºä¾‹ 4
è¾“å…¥ï¼š
```
s = "abc3[cd]xyz"
```
è¾“å‡ºï¼š
```
"abccdcdcdxyz"
```


---

# ğŸš€ æœ€ä¼˜è§£ï¼šåŒæ ˆæ³•ï¼ˆå­˜å­—ç¬¦ä¸²+å­˜é‡å¤æ¬¡æ•°ï¼‰

### ğŸ” æ€è·¯è§£æ
æ ¸å¿ƒç­–ç•¥ï¼š**ç”¨ä¸¤ä¸ªæ ˆåˆ†åˆ«æš‚å­˜â€œä¹‹å‰çš„å­—ç¬¦ä¸²â€å’Œâ€œé‡å¤æ¬¡æ•°â€ï¼Œé‡åˆ°æ‹¬å·æ—¶å®Œæˆâ€œæš‚å­˜-æ‹¼æ¥-é‡å¤â€çš„é€»è¾‘**ï¼Œå¤„ç†åµŒå¥—ç»“æ„ï¼š
1. åˆå§‹åŒ–å·¥å…·ï¼š
   - `strStack`ï¼šæ ˆï¼Œå­˜å‚¨â€œ`[`ä¹‹å‰çš„å­—ç¬¦ä¸²â€ï¼›
   - `digitStack`ï¼šæ ˆï¼Œå­˜å‚¨â€œ`[`å¯¹åº”çš„é‡å¤æ¬¡æ•°â€ï¼›
   - `sb`ï¼šå½“å‰æ‹¼æ¥çš„å­—ç¬¦ä¸²ï¼ˆStringBuilderï¼Œé¿å…é¢‘ç¹å­—ç¬¦ä¸²æ‹¼æ¥ï¼‰ï¼›
   - `digits`ï¼šç´¯ç§¯å¤šä½æ•°å­—ï¼ˆå¦‚â€œ123â€éœ€å…ˆå­˜ä¸ºå­—ç¬¦ä¸²å†è½¬æ•´æ•°ï¼‰ï¼›
2. éå†ç¼–ç å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ï¼š
   - **é‡åˆ°æ•°å­—**ï¼šç´¯ç§¯åˆ°`digits`ä¸­ï¼ˆå¤„ç†å¤šä½æ•°å­—ï¼Œå¦‚â€œ12â€â†’â€œ12â€ï¼‰ï¼›
   - **é‡åˆ°`[`**ï¼šå°†å½“å‰`sb`å‹å…¥`strStack`ã€`digits`è½¬æ•´æ•°å‹å…¥`digitStack`ï¼Œç„¶åé‡ç½®`sb`å’Œ`digits`ï¼›
   - **é‡åˆ°`]`**ï¼šå¼¹å‡º`digitStack`çš„é‡å¤æ¬¡æ•°`repeat`ã€å¼¹å‡º`strStack`çš„ä¹‹å‰å­—ç¬¦ä¸²`preSb`ï¼Œå°†`sb`çš„å†…å®¹é‡å¤`repeat`æ¬¡ï¼Œæ‹¼æ¥åˆ°`preSb`åï¼Œå†æŠŠ`preSb`èµ‹å€¼ç»™`sb`ï¼›
   - **é‡åˆ°å­—æ¯**ï¼šç›´æ¥è¿½åŠ åˆ°`sb`ä¸­ï¼›
3. éå†ç»“æŸåï¼Œ`sb`å³ä¸ºè§£ç åçš„å­—ç¬¦ä¸²ã€‚


---

## âœ… å®Œæ•´ä»£ç ï¼ˆJavaï¼‰
```java
import java.util.Scanner;
import java.util.Stack;

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        // Read the encoded string
        String s = scanner.nextLine();

        Solution solution = new Solution();
        String result = solution.decodeString(s);

        System.out.println(result);
        scanner.close();
    }
}

class Solution {
    public String decodeString(String s) {
        // æš‚å­˜ä¹‹å‰çš„å­—ç¬¦ä¸²
        Stack<StringBuilder> strStack = new Stack<>();
        // æš‚å­˜é‡å¤æ¬¡æ•°
        Stack<Integer> digitStack = new Stack<>();
        // å½“å‰æ‹¼æ¥çš„å­—ç¬¦ä¸²
        StringBuilder sb = new StringBuilder();
        // ç´¯ç§¯å¤šä½æ•°å­—
        StringBuilder digits = new StringBuilder();

        for (char c : s.toCharArray()) {
            if (Character.isDigit(c)) {
                // æƒ…å†µ1ï¼šé‡åˆ°æ•°å­—ï¼Œç´¯ç§¯åˆ°digits
                digits.append(c);
            } else if (c == '[') {
                // æƒ…å†µ2ï¼šé‡åˆ°[ï¼Œæš‚å­˜å½“å‰å­—ç¬¦ä¸²å’Œæ•°å­—
                strStack.push(sb);
                digitStack.push(Integer.parseInt(digits.toString()));
                // é‡ç½®å½“å‰å­—ç¬¦ä¸²å’Œæ•°å­—
                sb = new StringBuilder();
                digits.setLength(0);
            } else if (c == ']') {
                // æƒ…å†µ3ï¼šé‡åˆ°]ï¼Œæ‹¼æ¥é‡å¤åçš„å­—ç¬¦ä¸²
                int repeat = digitStack.pop();
                StringBuilder preSb = strStack.pop();
                // å°†å½“å‰sbé‡å¤repeatæ¬¡ï¼Œæ‹¼æ¥åˆ°preSbå
                for (int i = 0; i < repeat; i++) {
                    preSb.append(sb);
                }
                // æ›´æ–°å½“å‰å­—ç¬¦ä¸²ä¸ºæ‹¼æ¥åçš„ç»“æœ
                sb = preSb;
            } else {
                // æƒ…å†µ4ï¼šé‡åˆ°å­—æ¯ï¼Œç›´æ¥è¿½åŠ 
                sb.append(c);
            }
        }
        return sb.toString();
    }
}
```


---

# ğŸ§  é€šä¿—æ˜“æ‡‚è§£é‡Š
å¯ä»¥æŠŠåŒæ ˆæƒ³è±¡æˆâ€œæš‚å­˜ç®±â€ï¼Œä¸“é—¨å¤„ç†æ‹¬å·çš„åµŒå¥—é€»è¾‘ï¼š
- é‡åˆ°`[`ï¼šæŠŠâ€œå½“å‰å†™äº†ä¸€åŠçš„å†…å®¹â€å’Œâ€œè¦é‡å¤çš„æ¬¡æ•°â€æ”¾è¿›æš‚å­˜ç®±ï¼Œç„¶åé‡æ–°å¼€å§‹å†™æ‹¬å·é‡Œçš„å†…å®¹ï¼›
- é‡åˆ°`]`ï¼šä»æš‚å­˜ç®±é‡Œæ‹¿å‡ºâ€œä¹‹å‰çš„å†…å®¹â€å’Œâ€œé‡å¤æ¬¡æ•°â€ï¼ŒæŠŠæ‹¬å·é‡Œå†™çš„å†…å®¹å¤åˆ¶`n`éï¼Œç²˜åˆ°â€œä¹‹å‰çš„å†…å®¹â€åé¢ï¼Œç»§ç»­å†™åç»­å†…å®¹ã€‚

ä»¥ç¤ºä¾‹2 `s = "3[a2[c]]"` ä¸ºä¾‹ï¼Œè§£ç è¿‡ç¨‹åƒâ€œæ‹†ä¿„ç½—æ–¯å¥—å¨ƒâ€ï¼š
1. é‡åˆ°`3`â†’`digits="3"`ï¼›
2. é‡åˆ°`[`â†’æŠŠç©ºçš„`sb`å‹å…¥`strStack`ï¼Œ`3`å‹å…¥`digitStack`ï¼Œé‡ç½®`sb`å’Œ`digits`ï¼›
3. é‡åˆ°`a`â†’`sb="a"`ï¼›
4. é‡åˆ°`2`â†’`digits="2"`ï¼›
5. é‡åˆ°`[`â†’æŠŠ`sb="a"`å‹å…¥`strStack`ï¼Œ`2`å‹å…¥`digitStack`ï¼Œé‡ç½®`sb`å’Œ`digits`ï¼›
6. é‡åˆ°`c`â†’`sb="c"`ï¼›
7. é‡åˆ°`]`â†’å¼¹å‡º`repeat=2`ã€`preSb="a"`â†’`preSb`è¿½åŠ 2æ¬¡`c`â†’`sb="acc"`ï¼›
8. é‡åˆ°`]`â†’å¼¹å‡º`repeat=3`ã€`preSb=ç©º`â†’`preSb`è¿½åŠ 3æ¬¡`acc`â†’`sb="accaccacc"`ã€‚


---

# â± æ—¶é—´å¤æ‚åº¦
### **O(L)**
`L`æ˜¯**è§£ç åå­—ç¬¦ä¸²çš„é•¿åº¦**ï¼Œæ¯ä¸ªå­—ç¬¦æœ€ç»ˆä¼šè¢«æ‹¼æ¥/å¤„ç†ä¸€æ¬¡ï¼Œæ— å†—ä½™æ“ä½œã€‚


---

# ğŸ’¾ ç©ºé—´å¤æ‚åº¦
### **O(L)**
æ ˆçš„ç©ºé—´ï¼ˆå­˜å‚¨æš‚å­˜çš„å­—ç¬¦ä¸²å’Œæ•°å­—ï¼‰ã€`sb`çš„ç©ºé—´å‡ä¸è¶…è¿‡è§£ç åå­—ç¬¦ä¸²çš„é•¿åº¦`L`ã€‚


---
